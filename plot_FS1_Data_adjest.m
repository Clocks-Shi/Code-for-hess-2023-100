clear,clc
close all
%%
in_path='E:\Paper\Lake_ET\ET_ICE_Cover\odata\tables\';
o_path='E:\Paper\Lake_ET\ET_ICE_Cover\images\imges_v1\';
[data,text,data_text]=xlsread([in_path,'data_compare.xlsx']);
%%% OTa=1.013*CTa+0.7067 (1, 1.027)  (0.5861, 0.8272) R2=0.92; RMSE=2.62;
OTa=data(:,1);
CTa=data(:,2);
YTa=1.013*CTa + 0.7067;
%%% OTs=0.7053*ETs+ 3.303 (0.6951, 0.7155)  (3.186, 3.42) R2=0.90; RMSE=2.57;
OTs=data(:,3);
MTs=data(:,5);
ETs=data(:,6);
YTs=0.7053*ETs + 3.303;
%%% ORs=0.8565*CRs + 34.63 (0.8343, 0.8787) (29.78, 39.47) R2=0.73; RMSE=39.57;
%%% ORn=0.8943*CRs - 90.74 (0.8726, 0.916)  (-95.48, -86) R2=0.75; RMSE=38.73;
%%% OG= 0.8667*CRs - 151.5 (0.8384, 0.8951) (-157.7, -145.4) R2=0.63; RMSE=50.56;
ORs=data(:,7);
CRs=data(:,8);
CRl=data(:,9);
ORn=data(:,19);
ORg=data(:,20);
YRs=0.8565*CRs + 34.63;
YRn=0.8943*CRs - 90.74;
YG= 0.8667*CRs - 151.5;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
OWs=data(:,10);
CWs=data(:,11);
EWs=data(:,12);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
ORH=data(:,15);
CP=data(:,14);
q=data(:,16);
ea=6.105.*exp((17.27*CTa)./(CTa+237.7));
CRH=100*(CP.*q)./(0.622.*ea);
YRH=0.5191.*CRH+32.24;
%%%%%YRH=0.5191.*CRH+32.24;  (0.512 0.526) (31.88 32.61) 
OP=data(:,13);
%%
Odata{1}=OTa;
Odata{2}=OTs;
Odata{3}=ORs;

Rdata{1}=CTa;
Rdata{2}=ETs;
Rdata{3}=CRs;

Ydata{1}=YTa;
Ydata{2}=YTs;
Ydata{3}=YRs;
%%
mycolor=[238 118 0;0 255 127;0 0 255;238 99 99]./255;
ylab={'Observed Ta (°C)';'Observed Ts (°C)';'Observed Rs (W m^-^2)'};
xlab={'CMFD Ta (°C)';'ERA5 Ts (°C)';'CMFD Rs (W m^-^2)'};
H1=figure(1);
set(H1,'pos',[0.0026    0.1762    1.5288    0.4632]*10^3);
ha = tight_subplot(1,3,[.1 .06],[.14 .05],[.06 .01]); % 行间隔，列间隔，距下边界，上边界，左边界，右边界
for i = 1:3
axes(ha(i));
    h1=plot(Rdata{i},Odata{i},'LineStyle','none','Marker','o','MarkerEdgeColor',mycolor(3,:),'MarkerFaceColor','none','MarkerSize',6);
    hold on
    h2=plot(Rdata{i},Ydata{i},'LineStyle','-','Color',mycolor(4,:),'linewidth',1.5);
    hold on
    x=min(Rdata{i}):0.1:max(Rdata{i});
    h4=plot(x,x,'k-','linewidth',1.2);
    xlim([min(Rdata{i}) max(Rdata{i})]);
    ylim([min(Rdata{i}) max(Rdata{i})]);
 set(gca,'fontsize',16,'Fontname','Arial','FontWeight','bold');
 ylabel(ylab{i}, 'fontname','Arial','fontsize',16,'FontWeigh','bold');
 xlabel(xlab{i}, 'fontname','Arial','fontsize',16,'FontWeigh','bold'); 
 set(gca,'linewidth',1.2);
 box on 
end
 %%
% 创建 textbox
annotation(H1,'textbox',...
    [0.0729518576661432 0.826424869189816 0.140240714856931 0.0751295349552636],...
    'String','Y = 1.01 × X + 0.71',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.10042438513867 0.759930913765404 0.095761383602845 0.088946461018709],...
    'String','R^2 = 0.92***',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0828942961799998 0.136442140346984 0.0538984835989996 0.0751295349552636],...
    'String','Y = X',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.403145473574042 0.826424869189816 0.140240714856931 0.0751295349552638],...
    'String','Y = 0.71 × X + 3.30',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.430748822605956 0.759930913765404 0.0957613836028451 0.088946461018709],...
    'String','R^2 = 0.90***',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.438990580847711 0.170984454682044 0.0538984835989996 0.0751295349552636],...
    'String','Y = X',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');

% 创建 textbox
annotation(H1,'textbox',...
    [0.726274725274722 0.826424869189816 0.140240714856931 0.0751295349552638],...
    'String','Y = 0.86 × X + 34.63',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial',...
    'FitBoxToText','off');
% 创建 textbox
annotation(H1,'textbox',...
    [0.754401360544207 0.759930913765404 0.0957613836028453 0.088946461018709],...
    'String','R^2 = 0.73***',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial',...
    'FitBoxToText','off');
% 创建 textbox
annotation(H1,'textbox',...
 [0.733862375719504 0.133851466771854 0.0538984835989996 0.0751295349552635],...
    'String','Y = X',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial',...
    'FitBoxToText','off');
%%
% 创建 textbox
annotation(H1,'textbox',...
    [0.0278184196755624 0.913644212762308 0.0295656729717644 0.0803108822290554],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.344406593406587 0.913644212762308 0.0306122454718604 0.0803108822290551],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.678524856096278 0.913644212762308 0.0306122454718604 0.0803108822290551],...
    'String',{'c'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',20,...
    'FontName','Arial');
%%
 print('-djpeg','-r600', [o_path,'FS1_TS_Ta_Adjest']);