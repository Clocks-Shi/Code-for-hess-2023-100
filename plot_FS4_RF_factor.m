clear,clc
close all
%%
in_path='E:\Paper\Lake_ET\ET_ICE_Cover\odata\Site_ICP\For_R\';
mo_path='E:\Paper\Lake_ET\ET_ICE_Cover\images\imges_v1\';
[data1,~,data_text1]=xlsread([in_path,'R_result.xlsx'],'IF');
[data2,~,data_text2]=xlsread([in_path,'R_result.xlsx'],'IC');
ImcMSEdata=nan(11,4);
ImcMSEdata(1:end-1,1)=data1(21:30,5);
ImcMSEdata(1:end-1,2)=data1(21:30,9);
ImcMSEdata(:,3)=data2(21:31,1);
ImcMSEdata(:,4)=data2(21:31,6);
ImcMSETest=cell(4,1);
ImcMSETest{1}={'WS';'Δe';'Pres';'WD';'Ts';'Tl';'Rn';'Ta';'Ta-Ts';'albedo'};
ImcMSETest{2}={'WS';'WD';'Pres';'Δe';'Ts';'Tl';'albedo';'Ta-Ts';'Ta';'Rn'};
ImcMSETest{3}={'Ta-Ts';'Ta';'WS';'Rn';'ICR';'Pres';'WD';'Tl';'Δe';'Ts';'albedo'};
ImcMSETest{4}={'WS';'Ta';'Ta-Ts';'Rn';'ICR';'WD';'Pres';'albedo';'Tl';'Δe';'Ts'};
%%
x=-1:-1:-11;
x=x';
H1=figure(1);
set(H1,'pos',[ 0.0010    0.0010    1.5360    0.7896]*10^3);
ha = tight_subplot(2,2,[.08 .07],[.12 .05],[.06 .01]); % 行间隔，列间隔，距下边界，上边界，左边界，右边界
for i = 1:4
    axes(ha(i));
    ImcMSEdatai=ImcMSEdata(:,i);
    h=barh(x,ImcMSEdatai);
    h.FaceColor=[0 206 209]./255;
    h.EdgeColor=[0 206 209]./255;
    xlim([0 60]);
    ylim([-11.5 -0.5])
    if i==1 
       set(gca, 'FontSize',14,'YTick',-10:-1,'YTickLabel',flipud(ImcMSETest{i}));  
    elseif i==2
       set(gca, 'FontSize',14,'YTick',-10:-1,'YTickLabel',flipud(ImcMSETest{i}));    
    else
       set(gca, 'FontSize',14,'YTick',-11:-1,'YTickLabel',flipud(ImcMSETest{i}));
    end

%  set(gca, 'FontSize',14,'XTick',200:200:800,'YTickLabel',{'200';'400';'600';'800'});
 set(gca,'fontsize',14,'Fontname','Arial','FontWeight','bold');
 xlabel('\fontname{Arial}ImcMSET (%)', 'fontsize',16,'FontWeigh','bold');
 ylabel('\fontname{Arial}Variables', 'fontsize',16,'FontWeigh','bold');
 set(gca,'linewidth',1.2);
box on
end
%%
% 创建 textbox
annotation(H1,'textbox',...
    [0.0187083333333333 0.945795338591061 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.514802083333332 0.945795338591061 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0187083333333333 0.49341438621011 0.0294270838797093 0.0471124628273791],...
    'String',{'c'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.514802083333332 0.49341438621011 0.0294270838797093 0.0471124628273791],...
    'String',{'d'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
%%

% 创建 textbox
annotation(H1,'textbox',...
    [0.364802083333332 0.584599796616925 0.126562502862265 0.0440729490770999],...
    'String',{'Ice-free Daytime'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.884854166666664 0.584599796616925 0.108333335760981 0.0440729490770999],...
    'String',{'Ice-free Night'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.336416666666664 0.127406280912772 0.154687503532817 0.0440729490770999],...
    'String',{'Ice-covered Daytime'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.856729166666663 0.127406280912772 0.135937503085782 0.0440729490770999],...
    'String',{'Ice-covered Night'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
%% 保持图片
set(gcf,'PaperPositionMode','auto');
print('-djpeg', '-r600', [mo_path, 'FS4_RF_ Factor']);
