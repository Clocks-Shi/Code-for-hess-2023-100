clear,clc
close all
%% 
in_path='E:\Paper\Lake_ET\ET_ICE_Cover\odata\Site\';
mo_path='E:\Paper\Lake_ET\ET_ICE_Cover\images\imges_v1\';
load([in_path,'Sdata_ICP_Daily_2013_2018.mat'],'Sdata_DDICP','Sdata_DICP','Sdata_NICP',...
    'Sdata_DDICP_YM','Sdata_DICP_YM','Sdata_NICP_YM',...
     'Sdata_DDICP_Ystd','Sdata_DICP_Ystd','Sdata_NICP_Ystd');
year=2014:2018;
%% 
DDET_Seasonbox=nan(5,3,400);
DET_Seasonbox=nan(5,3,400);
NET_Seasonbox=nan(5,3,400);
for i =1:5
DDETi_IF=Sdata_DDICP{i+1,1}(:,2);
DETi_IF=Sdata_DICP{i+1,1}(:,2);
NETi_IF=Sdata_NICP{i+1,1}(:,2);

DDETi_IC=Sdata_DDICP{i+1,5}(:,2);
DETi_IC=Sdata_DICP{i+1,5}(:,2);
NETi_IC=Sdata_NICP{i+1,5}(:,2);

DDETi_AN=[DDETi_IF;DDETi_IC];
DETi_AN=[DETi_IF;DETi_IC];
NETi_AN=[NETi_IF;NETi_IC];
DDET_Seasonbox(i,1,1:length(DDETi_AN))=DDETi_AN;
DDET_Seasonbox(i,2,1:length(DDETi_IF))=DDETi_IF;
DDET_Seasonbox(i,3,1:length(DDETi_IC))=DDETi_IC;

DET_Seasonbox(i,1,1:length(DETi_AN))=DETi_AN;
DET_Seasonbox(i,2,1:length(DETi_IF))=DETi_IF;
DET_Seasonbox(i,3,1:length(DETi_IC))=DETi_IC;

NET_Seasonbox(i,1,1:length(NETi_AN))=NETi_AN;
NET_Seasonbox(i,2,1:length(NETi_IF))=NETi_IF;
NET_Seasonbox(i,3,1:length(NETi_IC))=NETi_IC;
end
ET{1}=DDET_Seasonbox;
ET{2}=DET_Seasonbox;
ET{3}=NET_Seasonbox;
ETS{1}=nansum(DDET_Seasonbox,3);
ETS{2}=nansum(DET_Seasonbox,3);
ETS{3}=nansum(NET_Seasonbox,3);
%%
ET_mean{1}=nanmean(DDET_Seasonbox,3);
ET_mean{2}=nanmean(DET_Seasonbox,3);
ET_mean{3}=nanmean(NET_Seasonbox,3);
ET_std{1}=nanstd(DDET_Seasonbox,1,3);
ET_std{2}=nanstd(DET_Seasonbox,1,3);
ET_std{3}=nanstd(NET_Seasonbox,1,3);
%%  单因子方差分析
% for i=1:5
%     DCO2_Seasonboxi=squeeze(DDET_Seasonbox(i,2:3,:));
%     DTCO2_Seasonboxi=squeeze(DET_Seasonbox(i,2:3,:));
%     DNCO2_Seasonboxi=squeeze(NET_Seasonbox(i,2:3,:));
%     [~,~,sd]=anova1(DCO2_Seasonboxi');
%     [~,~,sdt]=anova1(DTCO2_Seasonboxi');
%     [~,~,sdn]=anova1(DNCO2_Seasonboxi');
% [cd,~,~,gnamesd] = multcompare(sd);
% [cdt,~,~,gnamesdt] = multcompare(sdt);
% [cdn,~,~,gnamesdn] = multcompare(sdn);
%    AC{1,i}=cd;
%    AC{2,i}=cdt;
%    AC{3,i}=cdn;
%    close all
% end
%%
H1=figure(1);
set(H1,'pos',[ 0.0010    0.0010    1.5360    0.7896]*10^3);
ha = tight_subplot(3,2,[.01 .06],[.12 .05],[.04 .01]); % 行间隔，列间隔，距下边界，上边界，左边界，右边界
% set(ha,'pos',[0.0895348837209302 0.0914076782449726 0.88953488372093 0.877513711151737])
xset=[1 2 3 4 5];
sp1=[1 3 5];
sp2=[2 4 6];
for i = 1:3
axes(ha(sp1(i)));
ET_Seasonboxi=ET{i};
 h = boxplot2(ET_Seasonboxi,xset);
 cmap = get(0, 'defaultaxescolororder');
for ii = 1:3
    structfun(@(x) set(x(ii,:), 'color', cmap(ii,:), ...
        'markeredgecolor', cmap(ii,:)), h);
end
set([h.lwhis h.uwhis], 'linestyle', '-');
set([h.ladj h.uadj], 'linestyle', 'none');
set(h.out, 'marker', 'none');
set(h.box, 'linewidth', 1.5);
ylim([-2 8])
xlim([0.5 5.5])
 set(gca ,'XTickLabel','');
 set(gca, 'FontSize',14,'YTick',0:2:6,'YTickLabel',{'0';'2';'4';'6'});
 set(gca,'fontsize',14,'Fontname','Arial','FontWeight','bold');
 ylabel('\fontname{Arial}E (mm d^-^1)', 'fontsize',16,'FontWeigh','bold');
 set(gca,'linewidth',1.2);
box on

axes(ha(sp2(i)));
ESi=ETS{i};
 hg = bar(xset,ESi);
 cmap = get(0, 'defaultaxescolororder');
xlim([0.5 5.5])
ylim([0 900])
 set(gca, 'FontSize',14,'XTick',[1 2 3 4 5],'XTickLabel',{'2014/2015';'2015/2016';'2016/2017';'2017/2018';'2018/2019'});
 set(gca, 'FontSize',14,'YTick',200:200:800,'YTickLabel',{'200';'400';'600';'800'});
 set(gca,'fontsize',14,'Fontname','Arial','FontWeight','bold');
 ylabel('\fontname{Arial}E (mm yr^-^1)', 'fontsize',16,'FontWeigh','bold');
 set(gca ,'XTickLabel','');
%  xlabel('\fontname{Arial}Year','FontSize',16,'FontWeight','bold'); 
 set(gca,'linewidth',1.2);
box on





end
axes(ha(5));
set(gca, 'FontSize',14,'XTick',[1 2 3 4 5],'XTickLabel',{'2014/2015';'2015/2016';'2016/2017';'2017/2018';'2018/2019'});
xlabel('\fontname{Arial}Year','FontSize',16,'FontWeight','bold'); 
axes(ha(6));
set(gca, 'FontSize',14,'XTick',[1 2 3 4 5],'XTickLabel',{'2014/2015';'2015/2016';'2016/2017';'2017/2018';'2018/2019'});
xlabel('\fontname{Arial}Year','FontSize',16,'FontWeight','bold'); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 创建 textbox
annotation(H1,'textbox',...
    [0.0434479166666666 0.899696047883388 0.0526041677656273 0.0440729490770999],...
    'String','Daily',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0437083333333332 0.620820667944179 0.0734375015956661 0.0440729490770999],...
    'String','Daytime',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0439687499999999 0.339665652746611 0.0552083344943822 0.0440729490770999],...
    'String','Night',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',16,...
    'FontName','Arial');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 创建 legend
legend = legend(hg,{'Annual';'Ice-free';'Ice-covered'});
set(legend,...
    'Position',[0.891102429487639 0.296423198719951 0.0941406264528631 0.0823201639190875],...
    'FontSize',14,...
    'EdgeColor','none',...
   'Color','none');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0108958333333333 0.926545085298255 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.515843749999998 0.926545085298255 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0108958333333333 0.645390070100688 0.0294270838797093 0.0471124628273791],...
    'String',{'c'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.515843749999998 0.645390070100688 0.0294270838797093 0.0471124628273791],...
    'String',{'d'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0108958333333333 0.365248226129059 0.0294270838797093 0.0471124628273791],...
    'String',{'e'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.515843749999998 0.365248226129059 0.0294270838797093 0.0471124628273791],...
    'String',{'f'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
%%
% 创建 textbox
annotation(H1,'textbox',...
    [0.0749583333333332 0.700607901914263 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0955312499999998 0.700607901914263 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.16584375 0.700607901914263 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.186416666666666 0.700607901914263 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.254645833333333 0.700607901914263 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.275218749999999 0.700607901914263 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.343447916666666 0.700607901914263 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.364020833333332 0.700607901914263 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.431729166666666 0.700607901914263 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.452302083333331 0.700607901914263 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
%%
% 创建 textbox
annotation(H1,'textbox',...
    [0.0749583333333332 0.425531914072322 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0955312499999998 0.425531914072322 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.16584375 0.425531914072322 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.186416666666666 0.425531914072322 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.254645833333333 0.425531914072322 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.275218749999999 0.425531914072322 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.343447916666666 0.425531914072322 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.364020833333332 0.425531914072322 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.431729166666666 0.425531914072322 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.452302083333331 0.425531914072322 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
%%
% 创建 textbox
annotation(H1,'textbox',...
    [0.0749583333333332 0.130699087324602 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.0955312499999998 0.130699087324602 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.16584375 0.130699087324602 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.186416666666666 0.130699087324602 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.254645833333333 0.130699087324602 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.275218749999999 0.130699087324602 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.343447916666666 0.130699087324602 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.364020833333332 0.130699087324602 0.0294270838797093 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.431729166666666 0.130699087324602 0.0294270838797093 0.0471124628273791],...
    'String',{'a'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');
% 创建 textbox
annotation(H1,'textbox',...
    [0.452302083333331 0.130699087324602 0.0304687505712112 0.0471124628273791],...
    'String',{'b'},...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',18,...
    'FontName','Arial');

%% 保持图片
set(gcf,'PaperPositionMode','auto');
print('-djpeg', '-r600', [mo_path, 'F3_E_ Diurnal_Hhours']);
